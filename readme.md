# Matlab Occlusion Simulator

## Methodology

An occlusion evaluation software using Matlab was developed to evaluate possible dynamic occlusions. The input for this software uses simulation data generated by Aimsun Next. The methodology comprises three main steps: Running the Aimsun simulation, Evaluating the occlusions, and Generating the resulting heat map.

1. **Running Aimsun Simulation of a Road Network:**
A calibrated Aimsun simulation of an intersection is executed, and the vehicle positions throughout the simulation are collected.

2. **Evaluating Occlusion Based on Generated Data:**
The collected vehicle positions in the road network are used to evaluate occlusion generated by moving objects. The occlusion evaluation approach is illustrated in the figure below, showing a top-down view of an intersection with cars and buildings. The occlusion of one specific timestep is shown, based on all cars and buildings in the road network at that time.

<img src="images/sim_view.png"  width="50%">

Small black boxes represent manually driven cars without environment-observing sensors, generating dynamic occlusion for connected automated vehicles (CAVs). Small red boxes highlight the CAVs currently in the road network. A circle around each CAV indicates the occlusion it is subjected to by non-CAVs, represented by green and red circles.

Buildings in the image are downloaded from Open Street Maps
<a href="https://www.openstreetmap.org/">OpenStreetMap</a> - Published under referring to "Produced Work" <a href="https://opendatacommons.org/licenses/odbl/">ODbL</a>

3. **Generating an Occlusion Heat Map:**
A resulting heat map is generated based on an occupancy grid map with a one-meter resolution. Every time one or more CAVs observe a bin of this grid map during a timestep, the bin counter is increased by one. After the entire simulation run, a heat map is generated, showing which locations of the road network are dynamically occluded.

<img src="images/heat_map_view.png"  width="60%">

From the heat map, this approach can reveal dynamic occlusions in a road network and adjust the penetration rate of connected automated vehicles (CAVs) in a mixed-traffic scenario. The red arrow indicates where a dynamically occluded spot in the road network was observed. In summary, this methodology enables the evaluation of static and dynamic occlusions in urban intersections by running an Aimsun simulation of a road network, evaluating occlusion based on generated data, and generating an occlusion heat map.

## Requirements

The software requires the following dependencies:

### Hard Requirements:
- MATLAB
- Automated Driving Toolbox
- Mapping Toolbox

### Soft Requirements:
- Parallel Computing Toolbox


## Compatibility

The software was tested using MATLAB 2023a.

## Installation

1. Ensure that MATLAB is installed on your system.
2. Install the Automated Driving Toolbox and the Mapping Toolbox in MATLAB.
3. Download the latest release of the Dynamic Occlusion Evaluation Software.
4. Unzip the downloaded file to a directory of your choice.

## Usage

1. Open MATLAB.
2. Navigate to the directory where the Dynamic Occlusion Evaluation Software is installed.
3. Run the main MATLAB script to launch the software.
4. Follow the on-screen instructions to provide the necessary inputs and perform occlusion evaluation.

## License

This software is released under the [MIT License](LICENSE).

## Contact

For any inquiries or issues, please contact:

- Name: [Your Name]
- Email: [Your Email Address]
